<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title id="title">Question Bank</title>
</head>
<body onload="loadQuestions()">

<h2>Question Bank</h2>
<h3 id="score">Score:</h3>
<div id="q"></div>
<button onclick="done()">Submit</button>
<script>
var bank = [];
var altBank = [];
var numBankQuestions = 22;
var numAltQuestions = 0;
var order = [];
var altOrder = [];
function question(q, a, b, c, d, answer) {
  this.q = q;
  this.a = a;
  this.b = b;
  this.c = c;
  this.d = d;
  this.answer = answer; //From 1-4
}
function question(q, a, b, c, d, answer) {
  this.q = q;
  this.a = a;
  this.b = b;
  this.c = c;
  this.d = d;
  this.answer = answer; //From 1-4
}
</script>

<!-- Load question bank -->
<script src="banks/bio2b03midterm.js"></script>

<script>
function loadQuestions() {
  //Bank Questions
  var i = 0;
  while(i < numBankQuestions) {
    var random = Math.floor(Math.random() * bank.length);
    var repeated = false;
    for (var j = 0; j < order.length; j++) {
      if (random == order[j]) {
        repeated = true;
        break;
      }
    }
    if(!repeated) {
      if(bank[order[random]]) order.push(random);
      i++;
    }
  }
  //Alt Bank Questions
  i = 0;
  while(i < numAltQuestions) {
    var random = Math.floor(Math.random() * altBank.length);
    var repeated = false;
    for (var j = 0; j < altOrder.length; j++) {
      if (random == altOrder[j]) {
        repeated = true;
        break;
      }
    }
    if(!repeated) {
      if(bank[altOrder[random]) altOrder.push(random);
      i++;
    }
  }
  document.getElementById("q").innerHTML = "<form><hr/>"
  //Bank Questions
  for(var j = 0; j < order.length; j++) {
    document.getElementById("q").innerHTML += "<p>" + bank[order[j]].q + "<span id='q" + (j + 1) + "'></span></p><input type='radio' name='q" + (j + 1) + "' value='1'/>" + bank[order[j]].a + "<br/><input type='radio' name='q" + (j + 1) + "' value='2'/>" + bank[order[j]].b + "<br/><input type='radio' name='q" + (j + 1) + "' value='3'/>" + bank[order[j]].c + "<br/><input type='radio' name='q" + (j + 1) + "' value='4'/>" + bank[order[j]].d + "<br/><hr/>";
  }
  //Alt Bank Questions
  for(var j = 0; j < altOrder.length; j++) {
    document.getElementById("q").innerHTML += "<p>" + bank[altOrder[j]].q + "<span id='q" + (order.length + j + 1) + "'></span></p><input type='radio' name='q" + (order.length + j + 1) + "' value='1'/>" + bank[altOrder[j]].a + "<br/><input type='radio' name='q" + (order.length + j + 1) + "' value='2'/>" + bank[altOrder[j]].b + "<br/><input type='radio' name='q" + (order.length + j + 1) + "' value='3'/>" + bank[altOrder[j]].c + "<br/><input type='radio' name='q" + (order.length + j + 1) + "' value='4'/>" + bank[altOrder[j]].d + "<br/><hr/>";
  }
  document.getElementById("q").innerHTML += "</form>";
}

function done() {
  var score = 0;
  const form = document.querySelector("form");
  //Check answers for bank questions
  for (var j = 0; j < order.length; j++) {
    const selectedValue = form[`q${j + 1}`]?.value;
    if (selectedValue && parseInt(selectedValue) == bank[order[j]].answer) {
      score++;
      document.getElementById(`q${j + 1}`).innerText = " Correct!";
    } else {
      document.getElementById(`q${j + 1}`).innerText = " Wrong! Correct Answer: Option " + bank[order[j]].answer;
    }
  }
  //Check answers for alt bank questions
  for (var j = 0; j < altOrder.length; j++) {
    const selectedValue = form[`q${order.length + j + 1}`]?.value;
    if (selectedValue && parseInt(selectedValue) == bank[altOrder[j]].answer) {
      score++;
      document.getElementById(`q${order.length + j + 1}`).innerText = " Correct!";
    } else {
      document.getElementById(`q${order.length + j + 1}`).innerText = " Wrong! Correct Answer: Option " + altBank[altOrder[j]].answer;
    }
  }
  document.getElementById("score").innerText = "Score: " + score + "/" + (order.length + altOrder.length);
}
</script>
</body>
</html>
